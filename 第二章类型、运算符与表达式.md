# 类型、运算符与表达式
声明语句说明变量的名字和类型，也可以指定初始值。运算符指定将要进行的操作。表达式则把变量与常量组合起来生成新的值。对象的类型决定该对象可以取值的集合以及可以对该对象执行的操作。  
所有整型都包括signed和unsigned两种形式。

## 变量名
名字由字母（包括下划线）和数字组成。区分大小写。传统C语言中，变量全部使用小写，符号常量全部使用大写。由于库的命名通常使用下划线，所以一般命名不要以下划线开头。局部变量使用较短的名字，外部变量使用较长的名字。  

## 数据类型及长度
char    字符型，占一个字符。  
int     整型，通常反映所用机器中整数最自然的长度。  
float   单精度浮点数。     
double  双精度浮点数。   
long double     高精度浮点数。  

short和long用于限定整型，关键字int可以省略。short和int至少16位，long至少32位。short不得长于int，int不得长于long。  
signed和unsigned可以用于char和任何整型。  

## 常量
long类型的常量以l或L结尾，无符号常量以u或U结尾，float类型的常量以f或F结尾。前缀为0的整型常量表示八进制，前缀为0的整型常量表示十六进制。例如，0xful表示一个unsigned long类型，值等于十进制的15。  

一个字符常量是一个整数，如字符'0'在计算机中存储的值为48，与0没有关系。字符常量一般用于与其他字符比较，但也可以参与数值运算。可用'\ooo'和'\xhh'表示任意字符，其中ooo为八进制数，hh为十六进制数。字符常量'\0'表示值为0的字符，也就是空字符，通常用'\0'代表0。  
从技术上讲，字符串就是字符数组，以'\0'结尾。因此实际存储的字符比双引号中的字符数多一个。编译时将多个相邻的字符串连接起来，比如`"hello, " "world"`等价于`"hello, world"`。标准头文件`<string.h>`中声明了strlen和其他字符串函数。  

常量表达式在编译时求值。  

枚举常量是另外一种类型的常量。枚举是一个常量整型值的列表：
```C++
enum boolean {NO, YES}
```
在没有显式说明的情况下，enum类型的第一个枚举名的值为0，第二个为1，以此类推。如果部分指定了枚举名的值，那么未指定的枚举名的值将依最后一个指定值向后递增。
```C++
enum months {JAN = 1, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, DEC}
/*FEB的值为2，MAR的值为3，以此类推*/
```

## 声明
所有变量都必须先声明后使用。未经显式初始化的局部变量为未定义的值。默认情况下，外部变量和静态变量将被初始化为0。  

任何变量都可以加const修饰符，const限定该变量的值不可改变。  

## 算术运算符
二元算术运算符包括：+ - * / %(取模运算)   
取模运算不能用于float和double  

## 关系运算和逻辑运算符
关系运算符：> >= < >=   
等性运算符：== !=
逻辑运算符：&& | !   

关系运算符的优先级比算术运算符低，逻辑运算符的优先级比关系运算符和等性运算符低。
&&的优先级比||高。逻辑运算符具有短路特性，见第一章。  
一般用`if(!valid)`代替`if(valid == 0)`。  

## 类型转换
一般来说比较窄的操作数会自动转换为比较宽的操作数，而不损失信息。  
char转换为int：
1. 转换字符对应的数值：`c - '0'`  
2. 转换大写为小写：`c + 'a' - 'A'`
另外可以使用`<ctype.h>`中的函数。  

在if/while/for等语句的测试部分中，"真"就意味着"非0"，这二者没有区别。  

二元操作隐式转换规则：  
* 其中一个操作数为long double，则将另一个操作数转换为long double；  
* 其中一个操作数为double，则将另一个操作数转换为double；  
* 其中一个操作数为float，则将另一个操作数转换为float；  
* 将char与short类型的操作数转换为int类型；  
* 其中一个操作数为long，则将另一个操作数转换为long。  

注意float不会自动转换为double。  

当表达式中包含unsigned类型时，转换规则比较复杂，注意测试。  

赋值时也要进行类型转换。赋值运算符右边的值需要转换为左边变量的类型。  

强制类型转换：`(类型名)表达式`

## 自增运算符与自减运算符
只能作用于变量，不能用于表达式。注意前缀写法与后缀写法带来的副作用。  

## 按位运算符

&  按位与  常用于屏蔽某些位（`a & 0`，结果都为0）  
|  按位或  常用于设置某些位为1（`a | 1`，结果都为1）   
^  按位异或    
<< 左移  
\>> 右移  
~  按位求反  

例子：
```C
//返回x中从右边数第p位开始向右数n位的字段。假定最右边一位为0位。
unsigned getbits(unsigned x, int p, int n) {
    //将需要取的字段移到最右边，然后通常&0把高位屏蔽
    return (x >> (p+1-n)) & ~(~0 << n) ;
}
```

## 赋值运算符与表达式
大多数二元运算符都有一个对应的赋值运算符。`op=`，其中op可以是+ - * / % << >> & ^ |。赋值表达式的类型为左操作数的类型，值是赋值完成后的值。  
例如：`x *= y + 1`的含义是`x = x * (y + 1)`。  
赋值语句和赋值表达式具有值，可用于表达式中，如`(c = getchar()) != EOF`。

## 条件表达式
格式： `exp1 ? exp2 : exp3`，实际是一种表达式，可用于任何使用表达式的地方。`(n > 0) ? f : n`，类型是float，与最终结果无关。  

## 运算优先级
注意函数调用、嵌套赋值语句、自增、自减都有可能产生副作用。如`a[i] = i++`，数组下标究竟是新值还是旧值？不同的编译器不同。   
优先级不明的地方就用括号。  
